# Расширенная симуляция действий пользователя (10 шагов)

Этот документ описывает 10 ключевых шагов, которые выполняет наш автоматический скрипт для проверки полной работоспособности бэкенда.

## Сценарий: Полный цикл взаимодействия

### Шаг 1: Регистрация пользователя
**Запрос:** `POST /api/users/register/`
Создаем уникального пользователя для каждого теста. Бэкенд хеширует пароль и сохраняет профиль.

### Шаг 2: Авторизация (Login)
**Запрос:** `POST /api/users/login/`
Получение JWT access-токена для доступа к защищенным разделам (корзина, заказы).

### Шаг 3: Просмотр категорий
**Запрос:** `GET /api/shop/categories/`
Проверка работы связей в БД и корректности отдачи списка разделов.

**[Авто-подготовка данных]:** Если в базе нет товаров, скрипт автоматически создает тестовую категорию "Электроника" и товар "Смартфон X" через Django shell.

### Шаг 4: Поиск товара по названию
**Запрос:** `GET /api/shop/products/?search=phone`
Тестирование поисковых фильтров и DRF SearchFilter.

### Шаг 5: Просмотр карточки товара
**Запрос:** `GET /api/shop/products/{id}/`
Получение детальной информации о конкретном товаре из БД.

### Шаг 6: Добавление в корзину
**Запрос:** `POST /api/shop/cart/add/`
Проверка логики корзины (проверка остатка на складе, создание записи в `CartItem`).

### Шаг 7: Обновление профиля клиента
**Запрос:** `PATCH /api/users/profile/`
Имитация ситуации, когда пользователь уточняет адрес доставки перед заказом.

### Шаг 8: Проверка корзины перед оплатой
**Запрос:** `GET /api/shop/cart/`
Убеждаемся, что все товары на месте и итоговая сумма рассчитана верно.

### Шаг 9: Оформление заказа (Checkout)
**Запрос:** `POST /api/shop/orders/checkout/`
**Бэкенд:** Запуск атомарной транзакции -> списание со склада -> очистка корзины -> создание заказа.

### Шаг 10: Просмотр истории заказов
**Запрос:** `GET /api/shop/orders/`
Проверка, что новый заказ отображается в списке покупок пользователя.

---
## Как запустить
Выполните скрипт `./simulate_user.sh` в корневой папке проекта.
