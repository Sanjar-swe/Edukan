# Online Dúkan API

## 1. Цель проекта

Создание **RESTful API**, где пользователи могут просматривать товары, добавлять их в корзину и оформлять заказы, а администраторы могут управлять товарами.

## 2. Стек технологий

- **Язык:** Python 3.10+
- **Фреймворк:** Django 4.x, Django REST Framework (DRF)
- **База данных:** PostgreSQL
- **Аутентификация:** JWT (Simple JWT)
- **Документация:** Swagger (drf-yasg или drf-spectacular)
- **Медиа:** Хранение изображений (Media files)

---

## 3. Модели базы данных (Models)

Должны быть следующие модели и их поля:

### A. Пользователи (Users)

Использовать модель `AbstractUser` из Django или расширить её.

- **Role:** Admin, Klient.
- **Дополнительные поля:** Номер телефона, Адрес (Address).

### B. Категории (Categories)

Для группировки товаров.

- `name`: Название категории (Например: "Смартфоны", "Одежда").
- `slug`: Уникальное название для URL.
- `parent`: (Optional) Для подкатегорий (Например: Электроника -> Ноутбуки).

### C. Товары (Products)

- `category`: Связь с категорией (ForeignKey).
- `name`: Название товара.
- `slug`: Для URL.
- `description`: Полная информация.
- `price`: Цена (DecimalField).
- `discount_price`: Цена со скидкой (если есть).
- `image`: Изображение товара.
- `stock`: Количество на складе (Integer).
- `is_active`: Наличие товара в продаже.
- `created_at`, `updated_at`.

### D. Корзина (Cart & CartItems)

Для временного хранения товаров, которые пользователь хочет купить.

- **Cart:** `user` (пользователь).
- **CartItem:** `cart`, `product`, `quantity` (количество).

### E. Заказы (Order & OrderItems)

Оформленные покупки.

**Order:**

- `user`: Кто сделал заказ?
- `total_price`: Общая сумма.
- `status`: Статус (Ожидается, Оплачено, Отправлено, Отменено).
- `address`: Адрес доставки.
- `created_at`: Время.

**OrderItems:**

- `order`, `product`, `price`, `quantity`

![image.png](attachment:9e8573b7-0dd4-4881-87ed-d18058c43c5e:image.png)

---

## 4. Функциональные требования (API Endpoints)

### 1. Аутентификация и Авторизация

- **Регистрация:** Новый пользователь должен зарегистрироваться.
- **Login:** Получение JWT токена (Access & Refresh token).
- **Logout:** Аннулирование токена (optional).
- **Permissions:**
    - Просмотр товаров (GET) — Разрешено всем (AllowAny).
    - Добавление/изменение/удаление товаров — Только администраторам (IsAdminUser).
    - Корзина и Заказы — Только зарегистрированным пользователям (IsAuthenticated).

### 2. Товары (Products API)

- `GET /products/`: Вывод всех товаров (Пагинация обязательна).
- `GET /products/{id}/`: Просмотр конкретного товара.
- **Filtering & Searching:**
    - Поиск по названию (SearchFilter).
    - Фильтр по цене (min_price, max_price).
    - Фильтр по категории.
    - Сортировка (от дешевых к дорогим и наоборот).

### 3. Корзина (Cart API)

- `GET /cart/`: Просмотр корзины пользователя.
- `POST /cart/add/`: Добавить товар в корзину (ID товара и количество).
- `DELETE /cart/remove/{id}/`: Удалить товар из корзины.

### 4. Заказ (Order API)

- `POST /orders/checkout/`: Создать заказ из товаров в корзине. Здесь:
    - Количество товара на складе (`stock`) должно уменьшаться.
    - Корзина должна очищаться.
- `GET /orders/`: Пользователь должен видеть историю своих заказов.

---

## 5. Технические задания и валидация

1. **Pagination:** Выводить по 10 или 20 товаров на странице (`PageNumberPagination`).
2. **Validaciya:**
    - Если товара нет на складе (stock), не разрешать добавление в корзину.
    - При заказе количество товара не должно становиться отрицательным.
3. **Serializer:** Использовать `ModelSerializer` и где необходимо `Nested Serializers` (например, показывать название категории внутри товара).

---

## 6. Бонусные задания (дополнительно для оценки)

Если студент выполнил основное задание, можно добавить следующее:

1. **Reviews (Отзывы):** Пользователь может оставить комментарий и рейтинг (1-5 звезд) к купленному товару.
2. **Signals:** Отправка email "Добро пожаловать" новому пользователю при регистрации (Django Signals).
3. **Docker:** Запуск проекта через Docker-compose.
4. **Admin Panel:** Настройка Django Admin панели для удобного управления товарами (добавить поиск, фильтры).

---

## 7. Формат сдачи

1. Код проекта должен быть загружен в **GitHub** репозиторий.
2. Файл `README.md` обязателен. В нем:
    - Инструкция по запуску проекта.
